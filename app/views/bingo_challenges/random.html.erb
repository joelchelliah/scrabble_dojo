<% provide(:title, 'Bingo challenge: Random') %>
<div id="bingo-challenge" class="hero-unit">
  <%= heading 'Bingo', 'Challenge: Random' %>
  <div class="row">
    <div class="span11 center">
      <p>Find all possible bingos to advance to the next level.</p>
      <p>You can skip a level up to 3 times <span class='icon icon-heart'></span> &#10142; <span class='icon icon-remove'></span></p>
      <div id="bingo-challenge-box">
        <div id="lives-bar">
          <strong class="hidden-phone">Chances remaining:</strong>
          <%= challenge_lives %>
        </div>
        <div id="level-bar"> Level <%= @level %> </div>
        <div id="tiles-bar"> <%= @tiles.split(//).join(' ') %></div>
        <div id="challenge-form">
          <%= form_tag("/random_bingo_challenge", method: "get") do %>
            <div id="challenge-feedback" style="display:none;"></div>
            <div id="challenge-field">
              <%= hidden_field_tag :from_form, "true" %>
              <%= hidden_field_tag :level, @level %>
              <%= hidden_field_tag :lives, @lives %>
              <%= hidden_field_tag :tiles, @tiles %>
              <%= hidden_field_tag :found, @found.join(" ") %>
              <%= hidden_field_tag :failed, "" %>
              <%= text_field_tag :guess, "", placeholder: ". . ." %>
            </div>
            <div class="btn-group">
              <%= submit_tag "Submit", id: "submit-guess", class: "btn btn-primary btn-large" %>
              <%= link_to "Shuffle", "#", id: "shuffle", class: "btn btn-large" %>
            </div>
            <div id="bottom-btns" class="btn-group">
              <%= submit_tag " Skip ", id: "skip-challenge", class: "btn btn-danger btn-large" %>
              <%= submit_tag "Concede", id: "concede-challenge", class: "btn btn-inverse btn-large" %>
            </div>
          <% end %>
        </div>
        <div id="challenge-loading" style="display:none;">
          <p id="challenge-loading-pretext"></p>
          <p id="challenge-loading-level">Level <%= @level + 1 %>!</p>
          <p id="challenge-loading-missed"></p>
        </div>
        <div id="challenge-results">
          <p>Found <strong><span id="challenge-solutions-found">0</span> / <%= @solutions.count %></strong> bingos</p>
          <p id="challenge-solutions">
            <%= @solutions.map { |s| "<span id='s-#{s}' style='display:none;'>#{s}</span>"}.join(" ").html_safe %>
          </p>
        </div>
      </div>
      <p><%= link_to "Back to Bingo Challenges Overview", bingo_challenges_path %></p>
    </div>
  </div>
</div>